"use strict";(self.webpackChunkfreshCart=self.webpackChunkfreshCart||[]).push([[177],{5177:(v,c,l)=>{l.r(c),l.d(c,{PaymentComponent:()=>A});var m=l(6814),r=l(95),t=l(4769),f=l(1120),g=l(5371);function u(e,p){1&e&&(t.TgZ(0,"p"),t._uU(1,"Address Is Requierd"),t.qZA())}function C(e,p){if(1&e&&(t.TgZ(0,"div",11),t.YNc(1,u,2,0,"p",12),t.qZA()),2&e){const n=t.oxw();let s;t.xp6(1),t.Q6J("ngIf",null==(s=n.paymentForm.get("details"))||null==s.errors?null:s.errors.required)}}function o(e,p){1&e&&(t.TgZ(0,"p"),t._uU(1,"City Is Requierd"),t.qZA())}function a(e,p){if(1&e&&(t.TgZ(0,"div",11),t.YNc(1,o,2,0,"p",12),t.qZA()),2&e){const n=t.oxw();let s;t.xp6(1),t.Q6J("ngIf",null==(s=n.paymentForm.get("city"))||null==s.errors?null:s.errors.required)}}function y(e,p){1&e&&(t.TgZ(0,"p"),t._uU(1,"Phone Is Requierd"),t.qZA())}function I(e,p){1&e&&(t.TgZ(0,"p"),t._uU(1,"Enter Valid Phone Number"),t.qZA())}function P(e,p){if(1&e&&(t.TgZ(0,"div",11),t.YNc(1,y,2,0,"p",12),t.YNc(2,I,2,0,"p",12),t.qZA()),2&e){const n=t.oxw();let s,i;t.xp6(1),t.Q6J("ngIf",null==(s=n.paymentForm.get("phone"))||null==s.errors?null:s.errors.required),t.xp6(1),t.Q6J("ngIf",null==(i=n.paymentForm.get("phone"))||null==i.errors?null:i.errors.pattern)}}function U(e,p){1&e&&t._UZ(0,"i",13)}let A=(()=>{class e{constructor(n,s){this._ActivatedRoute=n,this._CartService=s,this.cartId="",this.checkCorrectData=!1,this.paymentForm=new r.cw({details:new r.NI(null,[r.kI.required]),phone:new r.NI(null,[r.kI.required,r.kI.pattern(/^(01)[0125][0-9]{8}/)]),city:new r.NI(null,[r.kI.required])})}ngOnInit(){this._ActivatedRoute.params.subscribe({next:n=>{this.cartId=n.id},error:n=>{console.log(n)}})}submit(){this.checkCorrectData=!0,this._CartService.checkOutSession(this.cartId,this.paymentForm.value).subscribe({next:n=>{console.log(n),"success"==n.status&&(this.checkCorrectData=!1,window.open(n.session.url,"_self"))},error:n=>{console.log(n)}})}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(f.gz),t.Y36(g.N))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-payment"]],standalone:!0,features:[t.jDz],decls:23,vars:6,consts:[[1,"shadow","rounded","p-4","my-4","bg-main-light"],[1,"w-75","mx-auto","py-5"],[1,"text-main"],[3,"formGroup","submit"],[1,"mb-3"],["formControlName","details",1,"form-control"],["class","alert alert-danger mt-2",4,"ngIf"],["formControlName","city",1,"form-control"],["formControlName","phone",1,"form-control"],["type","submit",1,"main-btn","text-white","d-block","ms-auto","p-2",3,"disabled"],["class","fa-solid fa-spinner fa-spin",4,"ngIf"],[1,"alert","alert-danger","mt-2"],[4,"ngIf"],[1,"fa-solid","fa-spinner","fa-spin"]],template:function(s,i){if(1&s&&(t.TgZ(0,"section",0)(1,"div",1)(2,"h3",2),t._uU(3,"Check Out:"),t.qZA(),t.TgZ(4,"form",3),t.NdJ("submit",function(){return i.submit()}),t.TgZ(5,"div",4)(6,"label"),t._uU(7,"Address :"),t.qZA(),t._UZ(8,"input",5),t.YNc(9,C,2,1,"div",6),t.qZA(),t.TgZ(10,"div",4)(11,"label"),t._uU(12,"City :"),t.qZA(),t._UZ(13,"input",7),t.YNc(14,a,2,1,"div",6),t.qZA(),t.TgZ(15,"div",4)(16,"label"),t._uU(17,"Phone :"),t.qZA(),t._UZ(18,"input",8),t.YNc(19,P,3,2,"div",6),t.qZA(),t.TgZ(20,"button",9),t._uU(21,"Pay "),t.YNc(22,U,1,0,"i",10),t.qZA()()()()),2&s){let _,d,h;t.xp6(4),t.Q6J("formGroup",i.paymentForm),t.xp6(5),t.Q6J("ngIf",(null==(_=i.paymentForm.get("details"))?null:_.errors)&&(null==(_=i.paymentForm.get("details"))?null:_.touched)),t.xp6(5),t.Q6J("ngIf",(null==(d=i.paymentForm.get("city"))?null:d.errors)&&(null==(d=i.paymentForm.get("city"))?null:d.touched)),t.xp6(5),t.Q6J("ngIf",(null==(h=i.paymentForm.get("phone"))?null:h.errors)&&(null==(h=i.paymentForm.get("phone"))?null:h.touched)),t.xp6(1),t.Q6J("disabled",i.paymentForm.invalid),t.xp6(2),t.Q6J("ngIf",i.checkCorrectData)}},dependencies:[m.ez,m.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return e})()},5371:(v,c,l)=>{l.d(c,{N:()=>g});var m=l(5619),r=l(4769),t=l(9862),f=l(1378);let g=(()=>{class u{constructor(o,a){this._HttpClient=o,this._AuthService=a,this.baseUrl="https://ecommerce.routemisr.com",this.cartNumber=new m.X(0),this.userId=this._AuthService.userId}addProduct(o){return this._HttpClient.post(`${this.baseUrl}/api/v1/cart`,{productId:o})}updateCart(o,a){return this._HttpClient.put(`${this.baseUrl}/api/v1/cart/${o}`,{count:a})}getUserCart(){return this._HttpClient.get(`${this.baseUrl}/api/v1/cart`)}rmoveSpecificItem(o){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart/${o}`)}clearCart(){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart`)}checkOutSession(o,a){return this._HttpClient.post(`${this.baseUrl}/api/v1/orders/checkout-session/${o}?url=http://localhost:4200`,{shippingAddress:a})}cashPayment(o,a){return this._HttpClient.post(`${this.baseUrl}/api/v1/orders/${o}`,{shippingAddress:a})}getAllUserOrders(){return this._HttpClient.get(`${this.baseUrl}/api/v1/orders/user/${this.userId}`)}static#t=this.\u0275fac=function(a){return new(a||u)(r.LFG(t.eN),r.LFG(f.e))};static#e=this.\u0275prov=r.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);