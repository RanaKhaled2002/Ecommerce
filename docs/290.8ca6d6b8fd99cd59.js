"use strict";(self.webpackChunkfreshCart=self.webpackChunkfreshCart||[]).push([[290],{5290:(g,d,s)=>{s.r(d),s.d(d,{CartComponent:()=>x});var u=s(6814),_=s(8129),m=s(1120),t=s(4769),h=s(5371);function l(n,C){if(1&n){const r=t.EpF();t.TgZ(0,"div",7)(1,"div",8),t._UZ(2,"img",9),t.qZA(),t.TgZ(3,"div",10)(4,"h1",11),t._uU(5),t.ALo(6,"cuttext"),t.qZA(),t.TgZ(7,"span",12),t._uU(8),t.qZA(),t.TgZ(9,"div",13)(10,"span"),t._uU(11),t.ALo(12,"currency"),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"span"),t._UZ(15,"i",14),t._uU(16),t.qZA()(),t.TgZ(17,"i",15),t.NdJ("click",function(){const i=t.CHM(r).$implicit,p=t.oxw(2);return t.KtG(p.removeItme(null==i.product?null:i.product._id))}),t.qZA()(),t.TgZ(18,"div",16)(19,"i",17),t.NdJ("click",function(){const i=t.CHM(r).$implicit,p=t.oxw(2);return t.KtG(p.updateCart("plus",i.count,null==i.product?null:i.product._id))}),t.qZA(),t._uU(20),t.TgZ(21,"i",18),t.NdJ("click",function(){const i=t.CHM(r).$implicit,p=t.oxw(2);return t.KtG(p.updateCart("minus",i.count,null==i.product?null:i.product._id))}),t.qZA()()()}if(2&n){const r=C.$implicit;t.xp6(2),t.Q6J("src",null==r.product?null:r.product.imageCover,t.LSH)("alt",null==r.product?null:r.product.title),t.xp6(3),t.Oqu(t.xi3(6,7,null==r.product?null:r.product.title,2)),t.xp6(3),t.Oqu(null==r.product||null==r.product.category?null:r.product.category.name),t.xp6(3),t.Oqu(t.xi3(12,10,r.price,"E\xa3")),t.xp6(5),t.hij(" ",null==r.product?null:r.product.ratingsAverage,""),t.xp6(4),t.hij(" ",r.count," ")}}const f=function(n){return["/payment",n]},c=function(n){return["/cash",n]};function o(n,C){if(1&n){const r=t.EpF();t.TgZ(0,"section")(1,"div")(2,"h1",2),t._uU(3),t.ALo(4,"currency"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.clearCart())}),t._uU(6,"Clear Cart"),t.qZA()(),t.YNc(7,l,22,13,"div",4),t.TgZ(8,"button",5),t._uU(9,"Online Payment"),t.qZA(),t.TgZ(10,"button",6),t._uU(11,"Cash Payment"),t.qZA()()}if(2&n){const r=t.oxw();t.xp6(3),t.hij("Total Price: ",t.xi3(4,4,r.totalPrice,"EGP"),""),t.xp6(4),t.Q6J("ngForOf",r.cartItems),t.xp6(1),t.Q6J("routerLink",t.VKq(7,f,r.cartId)),t.xp6(2),t.Q6J("routerLink",t.VKq(9,c,r.cartId))}}function v(n,C){1&n&&(t.TgZ(0,"h2",19),t._uU(1,"Your Cart Is Empty..."),t.qZA())}let x=(()=>{class n{constructor(r){this._CartService=r,this.cartItems=null,this.cartId=""}ngOnInit(){localStorage.setItem("currentPage","/cart"),this._CartService.getUserCart().subscribe({next:r=>{console.log(r),0==r.numOfCartItems?this.cartItems=null:(this.cartId=r.data._id,this.cartItems=r.data.products,this.totalPrice=r.data.totalCartPrice)},error:r=>{console.log(r)}})}removeItme(r){this._CartService.rmoveSpecificItem(r).subscribe({next:e=>{this.cartItems=e?.data?.products,this.totalPrice=e?.data?.totalCartPrice,this._CartService.cartNumber.next(e.numOfCartItems),console.log(this.cartItems?.length),0==this.cartItems?.length&&(this.cartItems=null)},error:e=>{console.log(e)}})}updateCart(r,e,a){e="plus"==r?(Number(e)+1).toString():(Number(e)-1).toString(),Number(e)>=1&&this._CartService.updateCart(a,e).subscribe({next:i=>{this.cartItems=i.data.products,this.totalPrice=i.data.totalCartPrice},error:i=>{console.log(i)}})}clearCart(){this._CartService.clearCart().subscribe({next:r=>{"success"==r.message&&(this.cartItems=null,this.totalPrice="",this._CartService.cartNumber.next(0))},error:r=>{console.log(r)}})}static#t=this.\u0275fac=function(e){return new(e||n)(t.Y36(h.N))};static#r=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["msg",""],[1,"py-2","text-center","text-main"],[1,"btn","btn-danger","my-3","d-block","ms-auto",3,"click"],["class","row py-5 align-items-center border-bottom shadow my-4 g-3",4,"ngFor","ngForOf"],[1,"main-btn","py-2","mb-3",3,"routerLink"],[1,"main-btn","py-2","mb-3","ms-4",3,"routerLink"],[1,"row","py-5","align-items-center","border-bottom","shadow","my-4","g-3"],[1,"col-md-3"],[1,"w-100",3,"src","alt"],[1,"col-md-7"],[1,"h5"],[1,"text-main","fw-bold"],[1,"py-3"],[1,"fa-solid","fa-star","rating-color"],[1,"fa-solid","fa-trash","text-danger","cursor-pointer",3,"click"],[1,"col-md-2"],[1,"fa-solid","cursor-pointer","h4","fa-square-plus","text-main",3,"click"],[1,"fa-solid","cursor-pointer","h4","fa-square-minus","text-main",3,"click"],[1,"text-center","text-main"]],template:function(e,a){if(1&e&&(t.YNc(0,o,12,11,"section",0),t.YNc(1,v,2,0,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",a.cartItems)("ngIfElse",i)}},dependencies:[u.ez,u.sg,u.O5,u.H9,_.r,m.rH]})}return n})()},5371:(g,d,s)=>{s.d(d,{N:()=>h});var u=s(5619),_=s(4769),m=s(9862),t=s(1378);let h=(()=>{class l{constructor(c,o){this._HttpClient=c,this._AuthService=o,this.baseUrl="https://ecommerce.routemisr.com",this.cartNumber=new u.X(0),this.userId=this._AuthService.userId}addProduct(c){return this._HttpClient.post(`${this.baseUrl}/api/v1/cart`,{productId:c})}updateCart(c,o){return this._HttpClient.put(`${this.baseUrl}/api/v1/cart/${c}`,{count:o})}getUserCart(){return this._HttpClient.get(`${this.baseUrl}/api/v1/cart`)}rmoveSpecificItem(c){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart/${c}`)}clearCart(){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart`)}checkOutSession(c,o){return this._HttpClient.post(`${this.baseUrl}/api/v1/orders/checkout-session/${c}?url=http://localhost:4200`,{shippingAddress:o})}cashPayment(c,o){return this._HttpClient.post(`${this.baseUrl}/api/v1/orders/${c}`,{shippingAddress:o})}getAllUserOrders(){return this._HttpClient.get(`${this.baseUrl}/api/v1/orders/user/${this.userId}`)}static#t=this.\u0275fac=function(o){return new(o||l)(_.LFG(m.eN),_.LFG(t.e))};static#r=this.\u0275prov=_.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()}}]);